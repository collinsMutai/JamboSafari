<div class="search-safari-container">
  <div class="search-bar">
    <input
      type="text"
      placeholder="Search for safari package... e.g. Maasai Mara, Lake Nakuru, Amboseli, Serengeti, Ngorongoro"
      [(ngModel)]="searchQuery"
      (input)="onSearch()"
    />
    <button *ngIf="searchQuery" (click)="clearSearch()">✖</button>
  </div>

  <div *ngIf="filteredPackages.length > 0" class="cards">
    <div *ngFor="let pkg of filteredPackages" class="card">
      <div class="card-header">{{ pkg.title }}</div>
      <div class="card-body">
        <img [src]="pkg.image" class="card-img" />
        <p><strong>Includes:</strong> {{ pkg.includes }}</p>
        <ul>
          <li *ngFor="let detail of pkg.details" >
             <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="icon-check"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M7 12l5 5l10 -10" />
            <path d="M2 12l5 5m5 -5l5 -5" /></svg
          > {{ detail }}
          </li>
        </ul>
        <div class="button-wrapper">
          <button class="view-details-btn" (click)="openModal(pkg, 'details')">View Details</button>
          <button class="book-now-btn" (click)="openModal(pkg, 'booking')">Book Now</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="selectedPackage && activeModal" class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ selectedPackage.title }} - {{ activeModal === 'details' ? 'Details' : 'Booking' }}</h3>
        <button class="close-btn" (click)="closeModal()">✖</button>
      </div>

      <div class="modal-body">
        <!-- View Details Modal -->
        <ng-container *ngIf="activeModal === 'details'">
          <p>{{ selectedPackage.fullDetails }}</p>
          <ul>
            <li style="list-style: none;"> <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="icon-check"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M7 12l5 5l10 -10" />
            <path d="M2 12l5 5m5 -5l5 -5" /></svg
          >Private Land Cruiser</li>
            <li style="list-style: none;"> <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="icon-check"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M7 12l5 5l10 -10" />
            <path d="M2 12l5 5m5 -5l5 -5" /></svg
          > Park entry & guides</li>
            <li style="list-style: none;"> <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="icon-check"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M7 12l5 5l10 -10" />
            <path d="M2 12l5 5m5 -5l5 -5" /></svg
          > Accommodation</li>
            <li style="list-style: none;"> <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="icon-check"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M7 12l5 5l10 -10" />
            <path d="M2 12l5 5m5 -5l5 -5" /></svg
          > Airport transfers</li>
          </ul>
        </ng-container>

        <!-- Booking Modal -->
        <ng-container *ngIf="activeModal === 'booking'">
          <form (ngSubmit)="onSubmitBooking()">
            <label for="name">Your Name:</label>
            <input
              type="text"
              id="name"
              [(ngModel)]="name"
              name="name"
              required
            />

            <label for="email">Your Email:</label>
            <input
              type="email"
              id="email"
              [(ngModel)]="email"
              name="email"
              required
            />

            <label for="phone">Your Phone:</label>
            <input
              type="text"
              id="phone"
              [(ngModel)]="phone"
              name="phone"
              required
            />

            <label for="adults">Number of Adults:</label>
            <input
              type="number"
              id="adults"
              [(ngModel)]="numAdults"
              name="numAdults"
              min="1"
              required
            />

            <label for="kids">Number of Kids:</label>
            <input
              type="number"
              id="kids"
              [(ngModel)]="numKids"
              name="numKids"
              min="0"
            />

            <label for="fromDate">From Date:</label>
            <input
              type="date"
              id="fromDate"
              [(ngModel)]="fromDate"
              name="fromDate"
              required
            />

            <label for="toDate">To Date:</label>
            <input
              type="date"
              id="toDate"
              [(ngModel)]="toDate"
              name="toDate"
              required
            />

            <div
              class="g-recaptcha"
              [attr.data-sitekey]="'6LeCsKYrAAAAAAjUr_cM1jdd9dG8XhtYSvRmfOeJ'"
            ></div>

            <button type="submit" class="book-now-btn" style="margin-top: 20px;">Confirm Booking</button>
          </form>
        </ng-container>
      </div>
    </div>
  </div>
</div>
